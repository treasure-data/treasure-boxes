name: production
keys:
  - name: td_client_id
    valid_regexp: "[0-9a-fA-F]{8}-..."
    invalid_texts: ['']
 
  - name: td_global_id
    valid_regexp: "[0-9a-fA-F]{8}-..."
    invalid_texts: ['', '0000000000-...']
 
  - name: email
    valid_regexp: ".*@.*"
 
tables:
  - database: prod
    table: pageviews
    incremental_columns: [updated_at, id]
    key_columns:
      - {column: td_client_id, key: td_client_id}
  - database: brand2
    table: pageviews
    as: brand2_pageviews
    key_columns:
      - {column: td_client_id, key: td_client_id}
      - {column: td_global_id, key: td_global_id}
      - {column: email, key: email}
 
  - database: prod
    table: contacts
    key_columns:
      - {column: email, key: email}
 
canonical_ids:
  - name: browser_id
    merge_by_keys: [td_client_id, td_global_id]
 
master_tables:
  - name: marketing_master
    canonical_id: browser_id
 
    attributes:
      - name: browser_id
        source_canonical_id: browser_id
 
      - name: email
        source_columns:
          - {table: contacts, column: email}